function ajaxUrl(music,callback){if(music.url!==null&&music.url!=="err"&&music.url!==""){callback(music);return true}if(music.id===null){music.url="err";updateMinfo(music);callback(music);return true}$.ajax({type:mkPlayer.method,url:mkPlayer.api,data:"types=url&id="+music.id+"&source="+music.source,dataType:"jsonp",success:function(jsonData){if(mkPlayer.debug){console.debug("歌曲链接"+jsonData.url)}if(jsonData.url==="")music.url="err";else music.url=jsonData.url;updateMinfo(music);callback(music);return true},error:function(XMLHttpRequest,textStatus,errorThrown){layer.msg('歌曲链接获取失败 - '+XMLHttpRequest.status);console.error(XMLHttpRequest+textStatus+errorThrown)}})}function ajaxPlayList(lid,id,callback){if(!lid)return false;if(musicList[id].isloading===true)return true;musicList[id].isloading=true;$.ajax({type:mkPlayer.method,url:mkPlayer.api,data:"types=playlist&id="+lid,dataType:"jsonp",complete:function(XMLHttpRequest,textStatus){musicList[id].isloading=false},success:function(jsonData){var tempList={id:lid,name:jsonData.playlist.name,cover:jsonData.playlist.coverImgUrl,creatorName:jsonData.playlist.crnickname,item:[]};if(jsonData.playlist.coverImgUrl!=='')tempList.cover=jsonData.playlist.coverImgUrl+"?param=200y200";else tempList.cover=musicList[id].cover;if(typeof jsonData.playlist.tracks!==undefined||jsonData.playlist.tracks.length!==0){for(var i=0;i<jsonData.playlist.tracks.length;i++){tempList.item[i]={id:jsonData.playlist.tracks[i].id,name:jsonData.playlist.tracks[i].name,artist:jsonData.playlist.tracks[i].arname,album:jsonData.playlist.tracks[i].alname,source:"default",url_id:jsonData.playlist.tracks[i].id,pic_id:null,lyric_id:jsonData.playlist.tracks[i].id,pic:jsonData.playlist.tracks[i].alpicurl,url:null}}}musicList[id]=tempList;if(id==mkPlayer.defaultlist)loadList(id);if(callback)callback(id);$(".sheet-item[data-no='"+id+"'] .sheet-cover").attr('src',tempList.cover);$(".sheet-item[data-no='"+id+"'] .sheet-name").html(tempList.name);if(mkPlayer.debug){console.debug("歌单 ["+tempList.name+"] 中的音乐获取成功")}},error:function(XMLHttpRequest,textStatus,errorThrown){console.error(XMLHttpRequest+textStatus+errorThrown);$(".sheet-item[data-no='"+id+"'] .sheet-name").html('<span style="color: #EA8383">读取失败</span>')}})}function ajaxLyric(music,callback){lyricTip('歌词加载中..');if(!music.lyric_id)callback('');$.ajax({type:mkPlayer.method,url:mkPlayer.api,data:"types=lyric&id="+music.lyric_id+"&source="+music.source,dataType:"jsonp",success:function(jsonData){if(mkPlayer.debug){console.debug("歌词获取成功")}if(jsonData.lyric){callback(jsonData.lyric,music.lyric_id)}else{callback('',music.lyric_id)}},error:function(XMLHttpRequest,textStatus,errorThrown){layer.msg('歌词读取失败 - '+XMLHttpRequest.status);console.error(XMLHttpRequest+textStatus+errorThrown);callback('',music.lyric_id)}})}