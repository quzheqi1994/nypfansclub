RewriteEngine on
RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^(.*)?$ https://%{SERVER_NAME}/$1 [R=301,L]
RewriteRule ^(.*?)([^/]*)\.htm$ $1/index.php?$2.htm$3 [L]
ErrorDocument 404 /404.php